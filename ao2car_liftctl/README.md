
## 梯控仓库简介

这是一个调用鲁邦云梯控设备的openAPI的软件仓库，基本实现了对鲁邦云梯控api的全流程控制

## 仓库结构
目前仓库结构如下：
```
.
├── config
├── debug
├── doc
├── log
├── README.md
├── requirements.txt
├── script
└── src
```
其中`config`文件用于存储鲁邦云接口密钥，`debug`文件用于对python文件做单元测试和基础功能调试，`doc`是鲁邦云梯控产品相关的软件接口文档，`log`文件用于存储执行文件过程中各项log数据，`script`文件用于存放清理仓库产生的缓存文件和log数据，`src`即为工程源文件

## 安装Python所需包

默认你会安装python
执行：
```
pip install -r requirements.txt
```

这个里面的包不一定全部都需要安装，多出来没用的包我没有筛除，不要在意有包没安装上，总之软件、电梯和你之间有一个能跑就行doge（

## 如何执行梯控
请务必看下main里的执行顺序和设置的参数，目前默认是执行九楼到一楼的梯控流程，并且debug时务必登陆梯控线上网站实时debug查询电梯状态。
在仓库根目录位置下：
```
(python_ws) ➜  ao2car_liftctl git:(main) ✗ pwd
=> /ao2car_liftctl
(python_ws) ➜  ao2car_liftctl git:(main) ✗ ls
=> config           debug            doc              log              main.py          README.md        requirements.txt script           src
```
然后执行：
```
python3 main.py
```
程序会访问云端接口，有时服务器响应很快一下就能调起服务，有时会需要等待十几秒钟。
然后可以梯控线上网站看到电梯实时状态里接收到了我们的任务请求，这表明请求成功。

## 如何执行门控
同梯控基本操作，门控需执行：
```
python3 door_control.py
```
将会开启公司后门（木门），如果执行失败请找公司IT索要新的密钥。

## 注意事项
如你在鲁邦云官方文档里所看，这一整套梯控逻辑采用的是https和mqtt组合闭环的，但是实际工程里我并没有用mqtt，因为mqtt遇到的问题是：使用https请求下来的mqtt访问帐号能登陆，
但是mqtt订阅的topic没有任何数据，我没有解决这个问题，选择采用定时器使用https定时请求电梯实时状态，通过匹配电梯状态参数来判断电梯是否到达了指定楼层，这并不规范但好歹能闭环。
后续如果有需要可以按官方方法去访问数据。

## Config配置文件
如你所见，`config`文件里目前是私人鲁邦云申请了接口密钥，如果后续因帐号变动导致密钥不可用，请向公司IT部门新增一个鲁邦云权限帐号，然后重新组册一个接口密钥，有问题找鲁邦云产品售后

## 关于后续变动等情况
你好朋友，如果你能看到这里，大概率说明梯控帐号失效了，请按照以下步骤操作：
1. 向公司IT说明情况，通过梯控帐号绑定人的帐号新增一个操作帐号
2. 在鲁邦云线上系统重新申请一个接口密钥
3. 更新本仓库`config`文件夹内的密钥，明文记录密钥有点蠢，有空想办法改进下吧
4. 简单调试，理论上不会有任何报错，大部分问题都可以通过`doc`里的文档来修复
5. 注意使用云服务每年是要缴费的，如果你上述操作都没效果看看是不是没缴费
6. 有问题找售后

## 更多信息
20250226留言注：
1. 该梯控产品绑定公司IT手机号码：陈晓兵13729934275，该梯控产品的产品访问接口等唯一电子密钥均需被绑定人授权获取。
2. 可访问梯控线上网站：https://ec.rdmscloud.com/#/login
3. 本地设备部署梯控API软件仓：https://git.ddt.dev:9281/rbt/ao2car/ao2car_liftctl
4. 边缘设备部署梯控API-ROS2软件仓：https://git.ddt.dev:9281/rbt/ao2car/ao2car_ros2/ao2car_system
5. 具体的电梯梯控产品实物在电梯面板内和电梯井上方，分别是一个电梯控制板和电梯梯控网关。

后续梯控帐号变动等请和公司IT联系！

最后祝你好运，我的朋友～